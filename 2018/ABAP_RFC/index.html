<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  
  
  
  
  
  <link rel="prev" href="https://coldinfire.github.io/2018/ABAP_TABLE_Maintenance/" />
  <link rel="next" href="https://coldinfire.github.io/2018/ABAP_BAPI_SUM/" />
  <link rel="canonical" href="https://coldinfire.github.io/2018/ABAP_RFC/" />
  <link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
            RFC 介绍  | Small Fire`s Blog
       
  </title>
  <meta name="title" content=" RFC 介绍  | Small Fire`s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=" RFC 介绍 "/>
<meta name="twitter:description" content="RFC : SAP Hlep Portal 链接 什么是 RFC RFC(Remote Function Call) 是 SAP 系统和其他（SAP 或非 SAP）系统间的一个重要而常用的双向接口技术，也被视为 SAP 与外部通信的基本协议。 简单地说"/>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": " RFC 介绍 ",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/coldinfire.github.io\/2018\/ABAP_RFC\/"
  },
  "image": {
    "@type": "ImageObject",
    "url": "https:\/\/coldinfire.github.io\/cover.png",
    "width":  800 ,
    "height":  600 
  },
  "genre": "posts",
  "keywords": "abapbasis",
  "wordcount":  2787 ,
  "url": "https:\/\/coldinfire.github.io\/2018\/ABAP_RFC\/",
  "datePublished": "2018-10-12T00:00:00\x2b00:00",
  "dateModified": "2018-10-12T00:00:00\x2b00:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "SmallFire",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/coldinfire.github.io\/logo.png",
      "width":  127 ,
      "height":  40 
    }
  },
  "author": {
    "@type": "Person",
    "name": "Small Fire"
  },
  "description": ""
}
</script>
</head>

  



  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="https://coldinfire.github.io">Small Fire`s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/books/" title="">Books</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;
                <a href="/search/" class="search"><i class="iconfont icon-t"></i></a>&nbsp;
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;<a href="https://coldinfire.github.io">Small Fire`s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/books/" title="">Books</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>

    	 <main class="main">
          <div class="container">
      		
<article class="post-warp">
    <header class="post-header">
        <h1 class="post-title"> RFC 介绍 </h1>
        <div class="post-meta">
            Written by <a href="https://coldinfire.github.io" rel="author">Small Fire</a> with ♥ 
                <span class="post-time">
                    on <time datetime=2018-10-12 >12 October 2018</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://coldinfire.github.io/categories/ABAP/"> ABAP </a>
                        
                </span>
                <i class="iconfont icon-timer"></i>
                6 min
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <p><a href="https://help.sap.com/viewer/753088fc00704d0a80e7fbd6803c8adb/7.5.10/en-US/485bc57cd004501ee10000000a421937.html">RFC : SAP Hlep Portal 链接</a></p>
<h3 id="什么是-rfc">什么是 RFC</h3>
<p>RFC(Remote Function Call) 是 SAP 系统和其他（SAP 或非 SAP）系统间的一个重要而常用的双向接口技术，也被视为 SAP 与外部通信的基本协议。</p>
<p>简单地说，RFC 过程就是系统调用当前系统外的程序模块，从而实现某个功能，而且调用系统和被调用系统中至少有一个必须是 SAP ABAP 系统。这种远程功能调用也可在同一系统内部进行（如本地 SAP 系统内的远程调用）；但通常情况下，调用程序和被调用程序处于不同系统。</p>
<h3 id="rfc-调用过程">RFC 调用过程</h3>
<p>在系统间通信过程中，需区分发送系统和接受系统。RFC 调用请求从发送系统（调用系统）中传至接收系统（被调用系统，也称远程系统或目标系统），发送请求的系统在通信过程中又称为 RFC 客户端，通信另一方则称为 RFC 服务器。RFC 客户端发起远程功能调用以执行 RFC 服务器提供的功能。</p>
<p>其中，调用系统和被调用系统均可以是 SAP 系统和非 SAP 系统，此外还可以在 SAP 系统内部将特定应用服务器指定为目标系统。</p>
<h3 id="rfc-通信的情况">RFC 通信的情况</h3>
<p>SAP 使用 CPIC（通信通用编程接口）协议在系统之间传输数据。它是 SAP 特定的协议。远程函数调用（RFC）是基于 CPI-C 的通信接口，但功能更多，应用程序员更容易使用。</p>
<p>根据通信方向和系统类型，共有如下三种 RFC 通信：</p>
<ul>
<li>
<p>两个独立的 SAP 系统之间的通信</p>
</li>
<li>
<p>SAP 系统作为调用系统，与外部远程系统（非 SAP ABAP 系统）通信</p>
</li>
<li>
<p>外部系统作为调用系统，与 SAP 系统通信</p>
</li>
</ul>
<h3 id="rfc-接口系统">RFC 接口系统</h3>
<p>SAP 调用远程功能的能力是通过 RFC 接口系统 (RFC interface system) 实现的。根据调用方向的不同（SAP 系统调用其他模块或其他系统调用 SAP 模块），RFC 接口提供以下两种服务。</p>
<ul>
<li>
<p>ABAP程序的调用接口</p>
</li>
<li>
<p>非SAP ABAP程序的调用接口</p>
</li>
</ul>
<h3 id="rfc-通信模式">RFC 通信模式</h3>
<p>RFC有同步通信(Synchronous RFC)和异步通信(Asynchronous RFC)两种方式。</p>
<h4 id="同步通信">同步通信</h4>
<p>同步通信使用单个函数调用，时间上允许误差较小。问题是如果目标系统不可用，源系统资源会等到目标系统可用。 这可能会导致源系统的进程在目标系统上进入睡眠/RFC/CPIC 模式，从而阻塞这些资源。</p>
<ul>
<li>用于 SAP Web Application Server 与 SAP GUI 之间的通信</li>
</ul>
<p><img src="/images/ABAP/RFC_1.png" alt="sRFC"></p>
<p>同步调用的优缺点</p>
<ul>
<li>
<p>优点：可以及时将数据返还给发送系统，数据对于通信是一致且可靠的</p>
</li>
<li>
<p>缺点：系统对话时必须保证两个系统处于活动状态，否则对话出现中断，影响业务应用的处理</p>
</li>
</ul>
<h4 id="异步通信">异步通信</h4>
<p>异步通信时间上允许一定的误差，从发送方系统分派功能调用时，接收系统不一定必须可用。接收系统可以在以后接收和处理该调用。如果接收系统不可用，则函数调用将保留在发送系统的出站队列中，从该位置开始定期进行重复调用，直到可以被接收系统处理为止。用户在继续调用会话之前，不需要等待它们的完成。</p>
<ul>
<li>用于并行处理</li>
</ul>
<p>异步通信特点：</p>
<ul>
<li>
<p>调用后，函数控制立即返回到调用程序</p>
</li>
<li>
<p>异步RFC的参数未记录到数据库，而是直接发送到服务器</p>
</li>
<li>
<p>异步RFC允许用户与远程系统进行交互式对话</p>
</li>
<li>
<p>当调用者启动aRFC时，被调用服务器必须可用于接受请求</p>
</li>
<li>
<p>调用程序可以从异步RFC接收结果</p>
</li>
</ul>
<p><img src="/images/ABAP/RFC_2.png" alt="aRFC"></p>
<p>异步调用的优缺点</p>
<ul>
<li>
<p>优点：不需要接收系统随时可用，如系统升级、维护等不影响请求发送系统的业务处理</p>
</li>
<li>
<p>缺点：不适用于要求及时响应的处理过程，通信不可靠，因为如果目标系统不可用，数据可能会丢失</p>
</li>
</ul>
<h3 id="rfc调用方式">RFC调用方式</h3>
<p><code>DESTINATION</code>：该参数告诉 SAP 系统被调用的函数在调用者以外的系统中运行。Destination 目的地通过事务 SM59 定义并存储在表 RFCDES。</p>
<h4 id="调用同步rfc">调用同步RFC</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ABAP" data-lang="ABAP"><span style="color:#66d9ef">CALL FUNCTION</span> func [DESTINATION dest]
  <span style="color:#66d9ef">EXPORTING</span>
    F1 <span style="color:#f92672">=</span> a1
  <span style="color:#66d9ef">IMPORTING</span>
    F2 <span style="color:#f92672">=</span> a2
  <span style="color:#66d9ef">CHANGING</span>
    F3 <span style="color:#f92672">=</span> a3
  <span style="color:#66d9ef">TABLES</span>
    T1 <span style="color:#f92672">=</span> ITAB
  <span style="color:#66d9ef">EXCEPTIONS</span>. 
</code></pre></div><h4 id="调用异步rfc">调用异步RFC</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ABAP" data-lang="ABAP"><span style="color:#66d9ef">CALL FUNCTION</span> <span style="color:#e6db74">&#39;RFC_SYSTEM_INFO&#39;</span> 
     STARTING NEW TASK <span style="color:#e6db74">&#39;AAAAAA&#39;</span>
     DESTINATION <span style="color:#e6db74">&#39;NONE&#39;</span>
     PERFORMING return_info <span style="color:#66d9ef">ON</span> <span style="color:#66d9ef">END OF</span> TASK  <span style="color:#75715e">&#34;接收异步调用结果&#34;
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">EXPORTING</span>...
  <span style="color:#66d9ef">TABLES</span>
    E_RETURN <span style="color:#f92672">=</span> L_IT_RETURN[]
  <span style="color:#66d9ef">EXCEPTIONS</span>
    COMMUNICATION_FAILURE <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">MESSAGE</span> MSG
    SYSTEM_FAILURE        <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">MESSAGE</span> MSG.
<span style="color:#66d9ef">IF</span> SY<span style="color:#f92672">-</span>SUBRC <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>.
  <span style="color:#66d9ef">WRITE</span>: <span style="color:#e6db74">&#39;Wait for response&#39;</span>.
  <span style="color:#66d9ef">WAIT</span> UNTIL SEMAPHORE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;X&#39;</span>.
<span style="color:#66d9ef">ELSE</span>.
  <span style="color:#66d9ef">WRITE</span> MSG.
  <span style="color:#66d9ef">MESSAGE</span> <span style="color:#e6db74">&#39;Synchronize Failed&#39;</span> TYPE <span style="color:#e6db74">&#39;A&#39;</span>.
<span style="color:#66d9ef">ENDIF</span>. 
</code></pre></div><p>从异步调用的函数接收结果，可以使用以下语法：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ABAP" data-lang="ABAP"><span style="color:#66d9ef">FORM</span> <span style="color:#a6e22e">RETURN_FLIGHT</span> <span style="color:#66d9ef">USING</span> TASKNAME.
  <span style="color:#66d9ef">RECEIVE</span> RESULTS <span style="color:#66d9ef">FROM</span> <span style="color:#66d9ef">FUNCTION</span> <span style="color:#e6db74">&#39;RFC_SYSTEM_INFO&#39;</span>
    <span style="color:#66d9ef">IMPORTING</span> 
      RFCSI_EXPORT <span style="color:#f92672">=</span> AAA
    <span style="color:#66d9ef">TABLES</span> 
      E_RETURN  <span style="color:#f92672">=</span> GV_IT_RETURN[]
    <span style="color:#66d9ef">EXCEPTIONS</span> 
      COMMUNICATION_FAILURE <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
      SYSTEM_FAILURE        <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">MESSAGE</span> 
       SYSTEM_MSG
    [KEEPING TASK].
  SEMAPHORE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;X&#39;</span>.
  <span style="color:#75715e">&#34;Refresh Screen&#34;
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">SET USER-COMMAND</span> <span style="color:#e6db74">&#39;OKCD&#39;</span>.
<span style="color:#66d9ef">ENDFORM</span>. 
</code></pre></div><p>添加 <strong>KEEPING TASK</strong> 可以阻止连接在接收处理结果后关闭。仅当您想将当前的远程上下文重新用于后续的异步调用时，才应使用附加的KEEPING TASK。保持远程上下文会增加存储负载，并由于系统中额外的滚动区域管理而降低性能。</p>
<p>WAIT UNTIL 使用</p>
<ul>
<li>WAIT UNTIL log_exp [UP TO sec SECONDS].</li>
</ul>
<p>只要逻辑表达式log_exp的结果为false，它就会中断程序的执行。可以为log_exp指定任何逻辑表达式。如果log_exp的结果为false，则程序将等待直到执行了先前异步调用的函数的回调例程，然后再次检查逻辑表达式。如果逻辑表达式的结果为true，或者已经执行了先前异步调用的所有函数的回调例程，则程序将继续执行WAIT之后的语句。</p>
<h3 id="rfc-版本包含的五种版本">RFC 版本包含的五种版本</h3>
<p>1、同步 RFC（sRFC， synchronous RFC）是 RFC 的第一个版本，它要求连接的双方是同步的工作方式，即都是在可用状态才能够实现成功调用。</p>
<p>2、异步 RFC（aRFC，asynchronous RFC）这种 RFC 可以实现异步的 RFC 调用方式，它可以进行多个并发调用，并且不要求被调用系统的可用状态。发出调用系统会一直尝试直到获得被调用系统的应答。它通常用于当你需要提高系统并行调用多个 RFC 的效率，相对于强制等待程序的结果，它的效率更高。</p>
<p>3、事物 RFC（tRFC，transactional RFC）是对 aRFC 进行相关技术改进后的一个 RFC 版本，其于 aRFC 相同点是实现异步调用，其优点是可以将多个调用进行 LUW 分组处理， 并只执行一次运行。tRFC 组件将调用的 RFC 函数与相应的数据一起存储在 SAP 数据库中的唯一事务 ID (TID) 下。  如果系统不可用，它会将数据写入带有事务 ID (SM58) 的 aRFC 表中，该 ID 由调度程序 RSARFCSE（每 60 秒运行一次）选择。</p>
<p>4、队列 RFC（qRFC，queue (d) RFC）是 tRFC 的一个增强版本，保证按应用程序指定的顺序处理多个 LUW（工作/事务的逻辑单元）。并可用于 SAP-SAP 及 SAP-non SAP。</p>
<p>5、并行 RFC（pRFC，Parallel RFC）是一种特殊的 RFC，它是 aRFC 的一种扩展类型。因为它改善了系统的性能，在执行大量的 aRFC 时。SAP 使用它在 MRP 里面提高速度。但是它只能执行在同一个系统和同一个 client 里。</p>
<h4 id="五种-rfc-调用特性对比">五种 RFC 调用特性对比</h4>
<table>
<thead>
<tr>
<th>对比内容</th>
<th>sRFC</th>
<th>aRFC</th>
<th>tRFC</th>
<th>qRFC</th>
<th>pRFC</th>
</tr>
</thead>
<tbody>
<tr>
<td>执行时间</td>
<td>立即执行</td>
<td>立即执行</td>
<td>需等待</td>
<td>需等待</td>
<td>立即执行</td>
</tr>
<tr>
<td>处理模式</td>
<td>同步</td>
<td>异步</td>
<td>异步，一次执行</td>
<td>异步，一次顺序执行</td>
<td>异步</td>
</tr>
<tr>
<td>交互对话</td>
<td>支持</td>
<td>支持</td>
<td>不支持</td>
<td>不支持</td>
<td>不建议使用</td>
</tr>
<tr>
<td>状态查询</td>
<td>不提供</td>
<td>不提供</td>
<td>提供</td>
<td>提供</td>
<td>不提供</td>
</tr>
</tbody>
</table>
<h3 id="rfc创建步骤">RFC创建步骤</h3>
<ol>
<li>
<p>通过T-Code: SE37，进入 RFC 开发初始界面</p>
</li>
<li>
<p>创建 RFC 与 Report 不同的是，RFC 程序需要先定义一个 Function Group，一个 Group 下可包含多个 Function。</p>
</li>
<li>
<p>Go to &ndash;&gt; Function Groups &ndash;&gt; Create Group</p>
</li>
<li>
<p>对 Function 进行属性设置，Processing Type =&gt; Remote-enabled module</p>
</li>
<li>
<p>Function 编辑器包含有七个页签：</p>
<ul>
<li>
<p>Attributes：设置Short text和Processing Type,是否允许外部调用。</p>
</li>
<li>
<p>Import：数据输入接口，接口参数可以为单个变量或则为一个结构体。</p>
</li>
<li>
<p>Export：数据输出接口，接口参数可以为单个变量或一个结构体。</p>
</li>
<li>
<p>Changing：将传入的表数据修改后返回</p>
</li>
<li>
<p>Tables：可同时作为输入输出接口，参数可谓单个变量或Struct或内表</p>
</li>
<li>
<p>Exceptions：异常输入几口，参数可以为单个变量或内表</p>
</li>
<li>
<p>Source Code ：ABAP代码编辑器，定义RFC的具体功能。</p>
</li>
</ul>
</li>
</ol>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Small Fire </span>
                </p>
            
           
            <p class="copyright-item">
                    <span>Words:</span>
                   <span>2787</span>
            </p>
            
            <p class="copyright-item">
                
            </p>

            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-icon-tag"></i>Tag: 
            
            <span class="tag"><a href="https://coldinfire.github.io/tags/abapbasis/">
                    #abapbasis</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">Back</a></span> · 
                <span><a href="https://coldinfire.github.io">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://coldinfire.github.io/2018/ABAP_TABLE_Maintenance/" class="prev" rel="prev" title=" SM30 表维护 "><i class="iconfont icon-dajiantou"></i>&nbsp; SM30 表维护 </a>
         
        
        <a href="https://coldinfire.github.io/2018/ABAP_BAPI_SUM/" class="next" rel="next" title=" BAPI 总结列表 "> BAPI 总结列表 &nbsp;<i class="iconfont icon-xiaojiantou"></i></a>
        
    </div>

    <div class="post-comment">
          
          <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2018-10-12 00:00:00 \x2b0000 UTC',
        title: ' RFC 介绍 ',
        clientID: 'd2cccd8844ae11b05792',
        clientSecret: 'cea63bc294ee16cb47a3344b693c350da1bb0753',
        repo: 'coldinfire.github.io',
        owner: 'coldinfire',
        admin: ['coldinfire'],
        body: decodeURI(location.href)
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>
  


          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2017 - 2022</span>
        
         
            <span class="author" itemprop="copyrightHolder"><a href="https://coldinfire.github.io">Small Fire</a> | </span>
         

		  <span>Crafted with ❤️ by <a href="https://github.com/Fastbyte01/KeepIt" target="_blank" rel="external nofollow noopener noreffer">KeepIt</a> & <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a></span>
    </div>
</footer>












    
     <link href="//lib.baomitu.com/lightgallery/1.6.12/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  







     </div>
  </body>
</html>
