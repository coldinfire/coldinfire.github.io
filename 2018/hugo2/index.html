<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  
  
  
  
  
  <link rel="prev" href="https://coldinfire.github.io/2018/hugo1/" />
  <link rel="next" href="https://coldinfire.github.io/2018/WEB_Maven/" />
  <link rel="canonical" href="https://coldinfire.github.io/2018/hugo2/" />
  <link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
            Hugo添加搜索功能(Algolia)   | Small Fire`s Blog
       
  </title>
  <meta name="title" content=" Hugo添加搜索功能(Algolia)   | Small Fire`s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=" Hugo添加搜索功能(Algolia)  "/>
<meta name="twitter:description" content="Algolia：博客框架 https://www.algolia.com/ Algolia配置 ​ ​ 记录API Keys相关信息： Application ID Search-Only API Key Admin API Key Hugo设置 在配置文件config中添加一下内容"/>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": " Hugo添加搜索功能(Algolia)  ",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/coldinfire.github.io\/2018\/hugo2\/"
  },
  "image": {
    "@type": "ImageObject",
    "url": "https:\/\/coldinfire.github.io\/cover.png",
    "width":  800 ,
    "height":  600 
  },
  "genre": "posts",
  "keywords": "hugo",
  "wordcount":  1024 ,
  "url": "https:\/\/coldinfire.github.io\/2018\/hugo2\/",
  "datePublished": "2018-02-06T00:00:00\u002b00:00",
  "dateModified": "2018-02-06T00:00:00\u002b00:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "SmallFire",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/coldinfire.github.io\/logo.png",
      "width":  127 ,
      "height":  40 
    }
  },
  "author": {
    "@type": "Person",
    "name": "Small Fire"
  },
  "description": ""
}
</script>
</head>

  



  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="https://coldinfire.github.io">Small Fire`s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/books/" title="">Books</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;
                <a href="/search/" class="search"><i class="iconfont icon-t"></i></a>&nbsp;
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;<a href="https://coldinfire.github.io">Small Fire`s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/books/" title="">Books</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>

    	 <main class="main">
          <div class="container">
      		
<article class="post-warp">
    <header class="post-header">
        <h1 class="post-title"> Hugo添加搜索功能(Algolia)  </h1>
        <div class="post-meta">
            Written by <a href="https://coldinfire.github.io" rel="author">Small Fire</a> with ♥ 
                <span class="post-time">
                    on <time datetime=2018-02-06 >6 February 2018</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://coldinfire.github.io/categories/%E5%B7%A5%E5%85%B7/"> 工具 </a>
                        
                </span>
                <i class="iconfont icon-timer"></i>
                3 min
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <p>Algolia：博客框架 <a href="https://www.algolia.com/">https://www.algolia.com/</a></p>
<h3 id="algolia配置">Algolia配置</h3>
<p>​	<img src="/images/Blog/algolia0.png" alt="Create Application"></p>
<p>​	<img src="/images/Blog/algolia2.png" alt="Create index"></p>
<p>记录API Keys相关信息：</p>
<ul>
<li>Application ID</li>
<li>Search-Only API Key</li>
<li>Admin API Key</li>
</ul>
<p><img src="/images/Blog/algolia3.png" alt="Create index"></p>
<h3 id="hugo设置">Hugo设置</h3>
<ol>
<li>在配置文件config中添加一下内容：</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">[<span style="color:#a6e22e">outputFormats</span>.<span style="color:#a6e22e">Algolia</span>]
  <span style="color:#a6e22e">baseName</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;algolia&#34;</span>
  <span style="color:#a6e22e">isPlainText</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
  <span style="color:#a6e22e">mediaType</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;application/json&#34;</span>
  <span style="color:#a6e22e">notAlternative</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
  
<span style="color:#960050;background-color:#1e0010">#</span><span style="color:#a6e22e">vars</span> <span style="color:#a6e22e">是</span> <span style="color:#a6e22e">Hugo</span> <span style="color:#a6e22e">内置变量</span><span style="color:#960050;background-color:#1e0010">；</span> <span style="color:#a6e22e">params</span> <span style="color:#a6e22e">是自定义变量</span><span style="color:#960050;background-color:#1e0010">，</span><span style="color:#a6e22e">按自己情况增减</span><span style="color:#960050;background-color:#1e0010">。</span>
[<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">algolia</span>]
  <span style="color:#a6e22e">vars</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;title&#34;</span>,<span style="color:#e6db74">&#34;date&#34;</span>, <span style="color:#e6db74">&#34;publishdate&#34;</span>, <span style="color:#e6db74">&#34;expirydate&#34;</span>, <span style="color:#e6db74">&#34;permalink&#34;</span>]
  <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;categories&#34;</span>, <span style="color:#e6db74">&#34;tags&#34;</span>,<span style="color:#e6db74">&#34;series&#34;</span>]

[<span style="color:#a6e22e">outputs</span>]
  <span style="color:#a6e22e">home</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;HTML&#34;</span>,<span style="color:#e6db74">&#34;RSS&#34;</span>,<span style="color:#e6db74">&#34;Algolia&#34;</span>]
</code></pre></div><p>2.在主题的根目录下 <code>layouts/_default</code>文件夹中新建 <code>list.algolia.json</code> 文件，文件内容如下</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS">{{<span style="color:#75715e">/* Generates a valid Algolia search index */</span>}}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">Scratch</span>.<span style="color:#a6e22e">Add</span> <span style="color:#e6db74">&#34;index&#34;</span> <span style="color:#a6e22e">slice</span> <span style="color:#f92672">-</span>}}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">$section</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">Site</span>.<span style="color:#a6e22e">GetPage</span> <span style="color:#e6db74">&#34;section&#34;</span> .<span style="color:#a6e22e">Section</span> }}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">range</span> .<span style="color:#a6e22e">Site</span>.<span style="color:#a6e22e">AllPages</span> <span style="color:#f92672">-</span>}}
{{<span style="color:#f92672">-</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">or</span> (<span style="color:#a6e22e">and</span> (.<span style="color:#a6e22e">IsDescendant</span> <span style="color:#a6e22e">$section</span>) (<span style="color:#a6e22e">and</span> (<span style="color:#a6e22e">not</span> .<span style="color:#a6e22e">Draft</span>) (<span style="color:#a6e22e">not</span> .<span style="color:#a6e22e">Params</span>.<span style="color:#66d9ef">private</span>))) <span style="color:#a6e22e">$section</span>.<span style="color:#a6e22e">IsHome</span> <span style="color:#f92672">-</span>}}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">Scratch</span>.<span style="color:#a6e22e">Add</span> <span style="color:#e6db74">&#34;index&#34;</span> (<span style="color:#a6e22e">dict</span> <span style="color:#e6db74">&#34;objectID&#34;</span> .<span style="color:#a6e22e">UniqueID</span> <span style="color:#e6db74">&#34;date&#34;</span> .Date.<span style="color:#a6e22e">UTC</span>.<span style="color:#a6e22e">Unix</span> <span style="color:#e6db74">&#34;description&#34;</span> .<span style="color:#a6e22e">Description</span> <span style="color:#e6db74">&#34;dir&#34;</span> .<span style="color:#a6e22e">Dir</span> <span style="color:#e6db74">&#34;expirydate&#34;</span> .<span style="color:#a6e22e">ExpiryDate</span>.<span style="color:#a6e22e">UTC</span>.<span style="color:#a6e22e">Unix</span> <span style="color:#e6db74">&#34;fuzzywordcount&#34;</span> .<span style="color:#a6e22e">FuzzyWordCount</span> <span style="color:#e6db74">&#34;keywords&#34;</span> .<span style="color:#a6e22e">Keywords</span> <span style="color:#e6db74">&#34;kind&#34;</span> .<span style="color:#a6e22e">Kind</span> <span style="color:#e6db74">&#34;lang&#34;</span> .<span style="color:#a6e22e">Lang</span> <span style="color:#e6db74">&#34;lastmod&#34;</span> .<span style="color:#a6e22e">Lastmod</span>.<span style="color:#a6e22e">UTC</span>.<span style="color:#a6e22e">Unix</span> <span style="color:#e6db74">&#34;permalink&#34;</span> .<span style="color:#a6e22e">Permalink</span> <span style="color:#e6db74">&#34;publishdate&#34;</span> .<span style="color:#a6e22e">PublishDate</span> <span style="color:#e6db74">&#34;readingtime&#34;</span> .<span style="color:#a6e22e">ReadingTime</span> <span style="color:#e6db74">&#34;relpermalink&#34;</span> .<span style="color:#a6e22e">RelPermalink</span> <span style="color:#e6db74">&#34;summary&#34;</span> .<span style="color:#a6e22e">Summary</span> <span style="color:#e6db74">&#34;title&#34;</span> .<span style="color:#a6e22e">Title</span> <span style="color:#e6db74">&#34;type&#34;</span> .<span style="color:#a6e22e">Type</span> <span style="color:#e6db74">&#34;url&#34;</span> .<span style="color:#a6e22e">URL</span> <span style="color:#e6db74">&#34;weight&#34;</span> .<span style="color:#a6e22e">Weight</span> <span style="color:#e6db74">&#34;wordcount&#34;</span> .<span style="color:#a6e22e">WordCount</span> <span style="color:#e6db74">&#34;section&#34;</span> .<span style="color:#a6e22e">Section</span> <span style="color:#e6db74">&#34;tags&#34;</span> .<span style="color:#a6e22e">Params</span>.<span style="color:#a6e22e">Tags</span> <span style="color:#e6db74">&#34;categories&#34;</span> .<span style="color:#a6e22e">Params</span>.<span style="color:#a6e22e">Categories</span> <span style="color:#e6db74">&#34;authors&#34;</span> .<span style="color:#a6e22e">Params</span>.<span style="color:#a6e22e">Authors</span>)}}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">-</span>}}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">end</span> <span style="color:#f92672">-</span>}}
{{<span style="color:#f92672">-</span> <span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">Scratch</span>.<span style="color:#a6e22e">Get</span> <span style="color:#e6db74">&#34;index&#34;</span> <span style="color:#f92672">|</span> <span style="color:#a6e22e">jsonify</span> <span style="color:#f92672">-</span>}}
</code></pre></div><p>执行 hugo 命令之后，在 public 目录下产生 algolia.json 文件。</p>
<h3 id="上传索引文件到algolia">上传索引文件到Algolia</h3>
<p>安装 atomic-algolia 包</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS"><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">init</span>
<span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">install</span> <span style="color:#a6e22e">atomic</span><span style="color:#f92672">-</span><span style="color:#a6e22e">algolia</span> <span style="color:#f92672">--</span><span style="color:#a6e22e">save</span>
</code></pre></div><p>会在目录中产生package.json 文件和package-lock.json文件，修改文件scripts 内容</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS"> <span style="color:#e6db74">&#34;scripts&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;test&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;echo \&#34;Error: no test specified\&#34; &amp;&amp; exit 1&#34;</span>,
    <span style="color:#e6db74">&#34;algolia&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;atomic-algolia&#34;</span>
  },
</code></pre></div><p>在创建的Blog本地项目中添加 .env文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS"><span style="color:#a6e22e">ALGOLIA_APP_ID</span><span style="color:#f92672">=</span><span style="color:#a6e22e">Application</span> <span style="color:#a6e22e">ID</span>
<span style="color:#a6e22e">ALGOLIA_ADMIN_KEY</span><span style="color:#f92672">=</span><span style="color:#a6e22e">Admin</span> <span style="color:#a6e22e">API</span> <span style="color:#a6e22e">Key</span>
<span style="color:#a6e22e">ALGOLIA_INDEX_NAME</span><span style="color:#f92672">=</span><span style="color:#a6e22e">Index_name</span>
<span style="color:#a6e22e">ALGOLIA_INDEX_FILE</span><span style="color:#f92672">=</span><span style="color:#66d9ef">public</span><span style="color:#f92672">/</span><span style="color:#a6e22e">algolia</span>.<span style="color:#a6e22e">json</span>
</code></pre></div><p>上传索引文件:通过Travis-CI触发，需要添加脚本命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JS" data-lang="JS"><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">run</span> <span style="color:#a6e22e">algolia</span>
</code></pre></div><p><img src="/images/Blog/algolia3.png" alt="Create index"></p>
<h3 id="主题ui添加">主题UI添加</h3>
<p>在主题文件下的 layouts下创建文件夹search，文件夹内创建两个文件list.html,search.html.</p>
<p>list.html</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{{ define &#34;content&#34; }}
&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;main&#34;</span>&gt;
    &lt;<span style="color:#f92672">article</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post&#34;</span>&gt;

        &lt;<span style="color:#f92672">head</span>&gt;
            &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;title&#34;</span>&gt;
                {{ if $.Scratch.Get &#34;h1&#34; }}
                &lt;<span style="color:#f92672">h1</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ .RelPermalink }}&#34;</span>&gt;{{ .Title }}&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
                {{ $.Scratch.Set &#34;h1&#34; false }} {{ else }}
                &lt;<span style="color:#f92672">h2</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ .RelPermalink }}&#34;</span>&gt;{{ .Title }}&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h2</span>&gt;
                {{ end }} {{ with .Description }}
                &lt;<span style="color:#f92672">p</span>&gt;{{ . }}&lt;/<span style="color:#f92672">p</span>&gt;
                {{ end }}
            &lt;/<span style="color:#f92672">div</span>&gt;
        &lt;/<span style="color:#f92672">head</span>&gt;
        &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;content&#34;</span>&gt;{{ partial &#34;search.html&#34; . }}&lt;/<span style="color:#f92672">div</span>&gt;
    &lt;/<span style="color:#f92672">article</span>&gt;
    <span style="color:#75715e">&lt;!-- USE SIDEBAR --&gt;</span>
    <span style="color:#75715e">&lt;!-- Post Container --&gt;</span>
    <span style="color:#75715e">&lt;!-- &lt;div class=&#34;
</span><span style="color:#75715e">            col-lg-4 col-lg-offset-1
</span><span style="color:#75715e">            col-md-4 col-md-offset-1
</span><span style="color:#75715e">            col-sm-4
</span><span style="color:#75715e">            col-xs-4
</span><span style="color:#75715e">            post-container
</span><span style="color:#75715e">        &#34;&gt;
</span><span style="color:#75715e">        {{ partial &#34;search.html&#34; . }}
</span><span style="color:#75715e">    &lt;/div&gt; --&gt;</span>
&lt;/<span style="color:#f92672">div</span>&gt;
{{ end }}
</code></pre></div><p>search.html</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{{ define &#34;content&#34; }}
&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/instantsearch.js@2.7.1/dist/instantsearch.min.css&#34;</span>&gt;
&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/instantsearch.js@2.7.1/dist/instantsearch-theme-algolia.min.css&#34;</span>&gt;
&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;search-box&#34;</span>&gt;
    <span style="color:#75715e">&lt;!-- SearchBox widget will appear here --&gt;</span>
  &lt;/<span style="color:#f92672">div</span>&gt;
  <span style="color:#75715e">&lt;!-- include algolia logo --&gt;</span>
 <span style="color:#75715e">&lt;!-- &lt;img src=&#34;https://www.algolia.com/static/logo-algolia-nebula-blue-full-57c56ea4b99b30c8f2cc03b65e8bb849.png&#34; style=&#34;float:right&#34; width=&#34;80px&#34;&gt;&lt;/img&gt; --&gt;</span>
  <span style="color:#75715e">&lt;!-- &lt;a href=&#34;https://www.algolia.com/&#34; target=&#34;_blank&#34;&gt;&lt;img src=&#34;https://www.algolia.com/static/logo-algolia-nebula-blue-full-57c56ea4b99b30c8f2cc03b65e8bb849.png&#34;&gt;&lt;/img&gt;&lt;/a&gt; --&gt;</span>
  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hits&#34;</span>&gt;
    <span style="color:#75715e">&lt;!-- Hits widget will appear here --&gt;</span>
  &lt;/<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;pagination&#34;</span>&gt;
    <span style="color:#75715e">&lt;!-- Pagination widget will appear here --&gt;</span>
  &lt;/<span style="color:#f92672">div</span>&gt;

&lt;<span style="color:#f92672">script</span>&gt;
<span style="color:#75715e">//initialize instantsearch
</span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">search</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">instantsearch</span>({
  <span style="color:#a6e22e">appId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#75715e">//Add your info
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">apiKey</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#75715e">//Add your info
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">indexName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>,<span style="color:#75715e">//Add your info
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">urlSync</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
});

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hitTemplate</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">hit</span>) {
<span style="color:#75715e">/*  if (hit === null){
</span><span style="color:#75715e">      return;
</span><span style="color:#75715e">  }*/</span>
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">date</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">date</span>) {
    <span style="color:#a6e22e">date</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">moment</span>.<span style="color:#a6e22e">unix</span>(<span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">date</span>).<span style="color:#a6e22e">format</span>(<span style="color:#e6db74">&#39;MMM D, YYYY&#39;</span>);
  }
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">#</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">anchor</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">title</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">_highlightResult</span>.<span style="color:#a6e22e">title</span>.<span style="color:#a6e22e">value</span>;
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">breadcrumbs</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">_highlightResult</span>.<span style="color:#a6e22e">headings</span>) {
    <span style="color:#a6e22e">breadcrumbs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">_highlightResult</span>.<span style="color:#a6e22e">headings</span>.<span style="color:#a6e22e">map</span>(<span style="color:#a6e22e">match</span> =&gt; {
      <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`&lt;span class=&#34;post-breadcrumb&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">match</span>.<span style="color:#a6e22e">value</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/span&gt;`</span>
    }).<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39; &gt; &#39;</span>)
  }
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span> ; 
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">_highlightResult</span>.<span style="color:#a6e22e">content</span>){
      <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">_highlightResult</span>.<span style="color:#a6e22e">content</span>.<span style="color:#a6e22e">value</span>;
  }
  <span style="color:#66d9ef">else</span>{
      <span style="color:#a6e22e">content</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">hit</span>.<span style="color:#a6e22e">summary</span>;
  }
  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">`
</span><span style="color:#e6db74">    &lt;div class=&#34;post-item&#34;&gt;
</span><span style="color:#e6db74">      &lt;span class=&#34;post-meta&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">date</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/span&gt;
</span><span style="color:#e6db74">      &lt;h2&gt;&lt;a class=&#34;post-link&#34; href=&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">title</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/a&gt;&lt;/h2&gt;
</span><span style="color:#e6db74">      &lt;a href=&#34;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; class=&#34;post-breadcrumbs&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">breadcrumbs</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/a&gt;
</span><span style="color:#e6db74">      &lt;div class=&#34;post-snippet&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">content</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/div&gt;
</span><span style="color:#e6db74">    &lt;/div&gt;
</span><span style="color:#e6db74">  `</span>;
}
<span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">addWidget</span>(
  <span style="color:#a6e22e">instantsearch</span>.<span style="color:#a6e22e">widgets</span>.<span style="color:#a6e22e">searchBox</span>({
    <span style="color:#a6e22e">container</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;#search-box&#39;</span>,
    <span style="color:#a6e22e">placeholder</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Search into posts...&#39;</span>,
    <span style="color:#a6e22e">poweredBy</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> <span style="color:#75715e">// This is required if you&#39;re on the free Community plan
</span><span style="color:#75715e"></span>  })
);
<span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">addWidget</span>(
  <span style="color:#a6e22e">instantsearch</span>.<span style="color:#a6e22e">widgets</span>.<span style="color:#a6e22e">hits</span>({
    <span style="color:#a6e22e">container</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;#hits&#39;</span>,
    <span style="color:#a6e22e">templates</span><span style="color:#f92672">:</span> {
      <span style="color:#a6e22e">item</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">hitTemplate</span>
    }
  })
);
<span style="color:#a6e22e">search</span>.<span style="color:#a6e22e">start</span>();
&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">style</span>&gt;
.<span style="color:#a6e22e">ais-search-box</span> {
  <span style="color:#66d9ef">max-width</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
  <span style="color:#66d9ef">margin-bottom</span>: <span style="color:#ae81ff">15</span><span style="color:#66d9ef">px</span>;
}
.<span style="color:#a6e22e">post-item</span> {
  <span style="color:#66d9ef">margin-bottom</span>: <span style="color:#ae81ff">30</span><span style="color:#66d9ef">px</span>;
}
.<span style="color:#a6e22e">post-link</span> .<span style="color:#a6e22e">ais-Highlight</span> {
  <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#111</span>;
  <span style="color:#66d9ef">font-style</span>: <span style="color:#66d9ef">normal</span>;
  <span style="color:#66d9ef">text-decoration</span>: <span style="color:#66d9ef">underline</span>;
}
.<span style="color:#a6e22e">post-breadcrumbs</span> {
  <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#424242</span>;
  <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">block</span>;
}
.<span style="color:#a6e22e">post-breadcrumb</span> {
  <span style="color:#66d9ef">font-size</span>: <span style="color:#ae81ff">18</span><span style="color:#66d9ef">px</span>;
  <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#424242</span>;
}
.<span style="color:#a6e22e">post-breadcrumb</span> .<span style="color:#a6e22e">ais-Highlight</span> {
  <span style="color:#66d9ef">font-weight</span>: <span style="color:#66d9ef">bold</span>;
  <span style="color:#66d9ef">font-style</span>: <span style="color:#66d9ef">normal</span>;
}
.<span style="color:#a6e22e">post-snippet</span> .<span style="color:#a6e22e">ais-Highlight</span> {
  <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#2a7ae2</span>;
  <span style="color:#66d9ef">font-style</span>: <span style="color:#66d9ef">normal</span>;
  <span style="color:#66d9ef">font-weight</span>: <span style="color:#66d9ef">bold</span>;
}
.<span style="color:#a6e22e">post-snippet</span> <span style="color:#f92672">img</span> {
  <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">none</span>;
}
&lt;/<span style="color:#f92672">style</span>&gt;

{{ end }}
</code></pre></div><p>在layouts\partials\header.html中引入search.html,显示搜索结果</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">nav</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;navbar&#34;</span>&gt;
    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;container&#34;</span>&gt;
        &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;navbar-header header-logo&#34;</span>&gt;
        	&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ .Site.BaseURL }}&#34;</span>&gt;{{ .Site.Title }}&lt;/<span style="color:#f92672">a</span>&gt;
        &lt;/<span style="color:#f92672">div</span>&gt;
        &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;menu navbar-right&#34;</span>&gt;
                {{ $currentPage := . }}
                {{ range .Site.Menus.main }}
                &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;menu-item{{if or ($currentPage.IsMenuCurrent &#34;</span><span style="color:#a6e22e">main</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">.)</span> <span style="color:#960050;background-color:#1e0010">($</span><span style="color:#a6e22e">currentPage</span><span style="color:#960050;background-color:#1e0010">.</span><span style="color:#a6e22e">HasMenuCurrent</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">main</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">.)</span> <span style="color:#960050;background-color:#1e0010">}}</span> <span style="color:#a6e22e">active</span><span style="color:#960050;background-color:#1e0010">{{</span><span style="color:#a6e22e">end</span><span style="color:#960050;background-color:#1e0010">}}&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ .URL }}&#34;</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ .Title }}&#34;</span>&gt;{{ .Name }}&lt;/<span style="color:#f92672">a</span>&gt;
                {{ end }}
                &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript:void(0);&#34;</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;theme-switch&#34;</span>&gt;&lt;<span style="color:#f92672">i</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;iconfont icon-sun&#34;</span>&gt;&lt;/<span style="color:#f92672">i</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;&amp;nbsp;
                &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/search/&#34;</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;search&#34;</span>&gt;&lt;<span style="color:#f92672">i</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;iconfont icon-t&#34;</span>&gt;&lt;/<span style="color:#f92672">i</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;&amp;nbsp;
        &lt;/<span style="color:#f92672">div</span>&gt;
    &lt;/<span style="color:#f92672">div</span>&gt;
&lt;/<span style="color:#f92672">nav</span>&gt;
</code></pre></div><p>以上配置完成后即可在首页使用搜索功能。</p>
<p><img src="/images/Blog/algolia5.png" alt="Create index"></p>
<p>参考文档：</p>
<ul>
<li>
<p><a href="https://10101.io/2018/11/23/search-with-algolia-in-hugo">采用 Algolia 作为 Hugo 搜索方案</a></p>
</li>
<li>
<p><a href="https://forestry.io/blog/search-with-algolia-in-hugo/">Static site search with Hugo + Algolia</a></p>
</li>
<li>
<p><a href="https://code.luasoftware.com/tutorials/algolia/add-algolia-search-to-hugo-static-website/">Add Algolia Search To Hugo Static Website</a></p>
</li>
</ul>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Small Fire </span>
                </p>
            
           
            <p class="copyright-item">
                    <span>Words:</span>
                   <span>1024</span>
            </p>
            
            <p class="copyright-item">
                
            </p>

            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-icon-tag"></i>Tag: 
            
            <span class="tag"><a href="https://coldinfire.github.io/tags/hugo/">
                    #hugo</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">Back</a></span> · 
                <span><a href="https://coldinfire.github.io">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://coldinfire.github.io/2018/hugo1/" class="prev" rel="prev" title=" 使用Hugo&#43;GitHub Pages快速搭建博客  "><i class="iconfont icon-dajiantou"></i>&nbsp; 使用Hugo&#43;GitHub Pages快速搭建博客  </a>
         
        
        <a href="https://coldinfire.github.io/2018/WEB_Maven/" class="next" rel="next" title="Maven使用">Maven使用&nbsp;<i class="iconfont icon-xiaojiantou"></i></a>
        
    </div>

    <div class="post-comment">
          
          <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var gitalk = new Gitalk({
        id: '2018-02-06 00:00:00 \u002b0000 UTC',
        title: ' Hugo添加搜索功能(Algolia)  ',
        clientID: 'd2cccd8844ae11b05792',
        clientSecret: 'cea63bc294ee16cb47a3344b693c350da1bb0753',
        repo: 'coldinfire.github.io',
        owner: 'coldinfire',
        admin: ['coldinfire'],
        body: decodeURI(location.href)
      });
      gitalk.render('gitalk-container');
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/gitalk/gitalk">comments powered by gitalk.</a></noscript>
  


          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2017 - 2021</span>
        
         
            <span class="author" itemprop="copyrightHolder"><a href="https://coldinfire.github.io">Small Fire</a> | </span>
         

		  <span>Crafted with ❤️ by <a href="https://github.com/Fastbyte01/KeepIt" target="_blank" rel="external nofollow noopener noreffer">KeepIt</a> & <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreffer">Hugo</a></span>
    </div>
</footer>












    
     <link href="//lib.baomitu.com/lightgallery/1.6.12/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  







     </div>
  </body>
</html>
